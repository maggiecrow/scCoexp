## Exploiting single-cell expression to characterize co-expression replicability
Megan Crow, Anirban Paul, Sara Ballouz, Z. Josh Huang, Jesse Gillis

#### Abstract

##### Background
Co-expression networks have been a useful tool for functional genomics, providing important clues about the cellular and biochemical mechanisms that are active in normal and disease processes. However, co-expression analysis is often treated as a black box with results being hard to trace to their basis in the data. Here, we use both published and novel single-cell RNA sequencing (RNA-seq) data to understand fundamental drivers of gene-gene connectivity and replicability in co-expression networks.

##### Results
We perform the first major analysis of single-cell co-expression, sampling from 31 individual studies. Using neighbor voting in cross-validation, we find that single-cell network connectivity is less likely to overlap with known functions than co-expression derived from bulk data, with functional variation within cell types strongly resembling that also occurring across cell types. To identify features and analysis practices that contribute to this connectivity, we perform our own single-cell RNA-seq experiment of 126 cortical interneurons in an experimental design targeted to co-expression. By assessing network replicability, semantic similarity and overall functional connectivity, we identify technical factors influencing co-expression and suggest how they can be controlled for. Many of the technical effects we identify are expression-level dependent, making expression level itself highly predictive of network topology. We show this occurs generally through re-analysis of the BrainSpan RNA-seq data.

##### Conclusions
Technical properties of single-cell RNA-seq data create confounds in co-expression networks which can be identified and explicitly controlled for in any supervised analysis. This is useful both in improving co-expression performance and in characterizing single-cell data in generally applicable terms, permitting cross-laboratory comparison within a common framework.Co-expression networks have been a useful tool for functional genomics, providing important clues about the cellular and biochemical mechanisms that are active in normal and disease processes. However, co-expression analysis is often treated as a “black box” with results being hard to trace to their basis in the data. In this work, we detail a series of experiments to break apart the box, using both published and novel single cell RNA-seq data to understand fundamental drivers of gene-gene connectivity and replicability in co-expression networks. We performed the first major analysis of single-cell co-expression, sampling from 31 individual studies comprising 28799 samples from 163 cell-types. Data from 163 bulk RNA-seq experiments were used as an external control. Using neighbor voting in cross-validation, we found that single cell network connectivity is less likely to overlap with known functions than co-expression derived from bulk data (sc AUROC=0.562 +/- 0.002, bulk AUROC=0.598 +/- 0.002) with functional variation within cell-types strongly resembling that also occurring across cell-types (r~0.95). To identify features and analysis practices that contribute to this connectivity, we performed our own single cell RNA-seq experiment of 126 cortical interneurons in an experimental design targeted to co-expression. By assessing network replicability, semantic similarity and overall functional connectivity we identified technical factors influencing co-expression and suggest how they can be controlled for. While networks showed much higher semantic similarities and replicabilities than expected by chance (~2-3 fold and ~1.5-2 fold, respectively), drop-outs and normalization could attenuate the functional connectivity of the network (~30% decrease in semantic similarity) even while replicability remained close to unchanged (1.8 vs 2-fold above the null).  Many of the technical effects we identified were expression level dependent, making expression level itself highly predictive of network topology. We show this occurs generally through re-analysis of the BrainSpan RNA-seq data. Technical properties of single-cell RNA-seq data create confounds in co-expression networks which can be identified and explicitly controlled for in any supervised analysis. This is useful both in improving co-expression performance and in characterizing single-cell data in generally applicable terms, permitting cross-laboratory comparison within a common framework. 

#### This site contains scripts to reproduce analyses in our [paper](http://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0964-6)
* **Networks are available to download [here](https://www.dropbox.com/sh/msn7c1nxo6equb7/AADk1xQStDm7N1FUtlvcoDMpa?dl=0).**
* Sample information for scRNA-seq and bulk meta-analysis can be found in scmeta.samples.txt and bulkmeta.samples.txt. 
* Code to process raw scRNA-seq data is available along with an example workflow (instructions.txt) and sample metadata file (sample.guide.txt)
* Expression data and metadata available to download from [GEO](http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=gse75049) and the number of total reads and UMIs for each sample can be found in readstats.csv
* BrainSpan RNA-seq data was downloaded from the [BrainSpan Consortium](http://www.brainspan.org/api/v2/well_known_file_download/267666525) (access date July 2015)
* Neighbor voting was performed using run_GBA.Rdata, and code was provided by Sara Ballouz. The generic GO slim was downloaded from the [Gene Ontology Consortium](http://geneontology.org/page/go-slim-and-subset-guide) (access date August 2015) and filtered for mammalian functions. The synaptic geneset was downloaded from the [Genes to Cognition](https://www.genes2cognition.org/db/GeneList/L0000000) database (access date February 2015)
* All other analyses were performed using R base functions as described in the paper (e.g. correlation, ranking, matrix aggregation, node degree calculations, rank sum test, Kolmogorov Smirnov test, Jaccard index). For any assistance reproducing analyses please contact mcrow@cshl.edu or jgillis@cshl.edu

###### under construction
